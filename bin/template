#!/bin/bash

src=""
dst=""
cmd=$1
shift

TEMPLATES_DIR=~/Templates

show_help(){
	echo "template (show|use|add) [--src SOURCE [--dst DESTINATION]]

	show : show content of templates directory

	use : copy SOURCE to DESTINATION or to current directory if DESTINATION
	      is not specified

	add : copy SOURCE into templates directory under the same name if
		  DESTINATION is not specified or under the name DESTINATION if it
		  has been specified

"
}

do_command()
{
	if [[ $cmd == "add" ]] ; then
		add_command
	elif [[ $cmd == "use" ]] ; then
		use_command
	elif [[ $cmd == "show" ]] ; then
		show_command
	elif [[ $cmd == "help" ]] ; then
		show_help
	else
		echo "Invalid command $cmd"
		show_help
		exit 1
	fi
}


show_command()
{
	ls $TEMPLATES_DIR/$src
	return
	if [[ $(uname) == Darwin ]] ; then
		open $TEMPLATES_DIR/$src
	else
		gvfs-open $TEMPLATES_DIR/$src
	fi
}

add_command()
{
	if [[  "$src" == "" ]] ; then
		echo "--src SOURCE must be specified for add"
		show_help
		exit 1
	fi

	if [[  "$dst" == "" ]] ; then
		dst=$src
	fi

	if [ -e $TEMPLATES_DIR/$dst ] ; then
		echo "Destination $dst already exists"
		return
	fi


	echo ADDING
	cp -R $src $TEMPLATES_DIR/$dst
}

use_command()
{
	if [[  "$src" == "" ]] ; then
		echo "--src SOURCE must be specified for use"
		show_help
		exit 1
	fi

	if [[ "$dst" == "" ]] ; then
		dst=$src
	fi

	if [ -e $dst ] ; then
		echo "Destination $dst already exists"
		return
	fi

	cp -R $TEMPLATES_DIR/$src $dst
}

while [[ $# -gt 1 ]]
do
	option=$1
	optarg=$2
	case $option in
		-s|--src)
			src=$optarg
			shift
			;;
		-d|--dst)
			dst=$optarg
			shift
			;;
		*)
			echo "unknown option $option"
	esac
	shift
done

echo "src=$src dst=$dst"


do_command
